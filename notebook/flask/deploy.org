#+TITLE:      Flask - 部署

* 目录                                                    :TOC_4_gh:noexport:
- [[#iis-部署][IIS 部署]]
- [[#debian--nginx-部署][Debian + Nginx 部署]]

* IIS 部署
  + [[https://segmentfault.com/a/1190000008909201][在 Windows 平台使用 IIS 部署 Flask 网站]]

  问题： IIS 拒绝 PUT, DELETE 等请求
  解决： [[https://stackoverflow.com/questions/6739124/iis-7-5-enable-put-and-delete-for-restful-service-extensionless][IIS 7.5 + enable PUT and DELETE for RESTFul service, extensionless]]

  在 ~web.config~  中添加：
  #+BEGIN_SRC xml
    <modules>
      <remove name="WebDAVModule" />
    </modules>
    <handlers>
      <remove name="WebDAV" />
    </handlers>

    <security>
      <requestFiltering>
        <verbs allowUnlisted="false">
          <add verb="GET" allowed="true" />
          <add verb="POST" allowed="true" />
          <add verb="DELETE" allowed="true" />
          <add verb="PUT" allowed="true" />
        </verbs>
      </requestFiltering>
    </security>
  #+END_SRC

* Debian + Nginx 部署
  + [[https://www.cnblogs.com/Ray-liang/p/4173923.html][阿里云部署 Flask + WSGI + Nginx 详解]]

  问题： 编译 uWSGI 失败
  解决： [[https://stackoverflow.com/questions/44037637/error-installing-uwsgi-in-virtualenv][Error installing uwsgi in virtualenv]]

  #+BEGIN_SRC bash
    $ apt-get install python3-all-dev
  #+END_SRC

  参考： [[https://uwsgi-docs.readthedocs.io/en/latest/WSGIquickstart.html][Quickstart for Python/WSGI applications]]

  问题： Supervisor 的作用
  解决： 启动并管理 ~Flask~ 程序， ~Nginx~ 只负责通讯，不负责启动管理程序

  问题： 根目录路径设置
  解决： 类似 ~~/path~ 的目录应该设置为 ~/root/path~


