#+TITLE:      存储

* 目录                                                    :TOC_4_gh:noexport:
- [[#图片的存储方案][图片的存储方案]]

* 图片的存储方案
  首先，在数据库里存储二进制文件不是一个好主意，理由如下：
  + 将二进制文件存储在数据库中，除了对它进行 I/O 操作以外，你不能对它做其他任何操作（索引、比较……）
  + 备份和恢复数据库需要更多的时间
  + 图像倾向于使用绘画工具进行编辑，将其保存为文件更为方便
  + ……

  这一点的讨论可以参考：
  + [[https://www.quora.com/Why-is-it-considered-bad-to-store-images-in-a-database][Why is it considered bad to store images in a database? - Quora]]

  那么，我们保存图片的方式必然是将文件保存在文件系统中，同时在数据库中保存图片文件的路径。

  这是问题便转换为了目录结构的设计问题，需要考虑单个文件夹保存多少图片，建立几级目录……

  这里需要注意的便是：文件夹中的文件过多是会影响 I/O 性能的。

  这一点可以参考：
  + [[https://segmentfault.com/q/1010000000121448][图片存储 - 图片服务器应该如何设计文件结构？ - SegmentFault 思否]]

  在存储时，可以计算得到图片的 hash 值，避免重复存储。
  
